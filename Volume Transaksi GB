select
			as_of_date
			,segment_after_insurance
			,channel_type_l1_outlet_referral
			,channel_type_l1_after_insurance
			,channel_owner_l1_outlet_referral
			,channel_type_l2_outlet_referral
			,channel_type_l2_after_insurance
			,channel_owner_l2_outlet_referral
			,case
	            when trim(kontragaransi) = 'Asuransi' then 'INT'
	            when CHANNEL_OWNER_MIRROR is not null then CHANNEL_OWNER_MIRROR
                else 'TIDAK MIRROR'
                end as channel_owner_mirror_after_insurance
			,count(id_opbg) as freq
			,sum(approval_amt_idr) as amount
		from PRD_DB_SBX_IND.MART_TRX_GARANSI_BANK
		where selected_flag = 'Realisasi Volume'
		-- and as_of_date between cast(concat(year(curdate() - interval 1 month),'-01','-31') as date) and last_day(curdate() - interval 1 month)
    AND AS_OF_DATE = '2025-06-30'
		group by 1,2,3,4,5,6,7,8,9
